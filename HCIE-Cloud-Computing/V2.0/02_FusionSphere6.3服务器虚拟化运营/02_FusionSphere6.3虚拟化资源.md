创建虚拟机需要准备资源(计算资源、存储资源、网络资源)

存储　

- FC SAN场景(服务器通过HBA卡连接到SAN网络，存储设备LUN，存储方式LUN挂载给多台主机；SAN网络使用光纤连接，使用专门的存储光纤交换机)
- iSCSI存储场景(服务器通过网卡连接到LAN网络；存储方式LUN，LAN网络，TCP/IP连接，以太网交换机)
- NAS存储场景(服务器通过网卡连接到LAN网络；存储设备:共享文件夹，常见为共享存储方式，共享文件夹共享给多台主机，LAN网络，TCP/IP连接，以太网交换机)

存储虚拟化解决方案
- 多路径技术UltraPath 为了提高可靠性，主机通过多个HBA卡连接多个SAN交换机连接到存储阵列，但是会出现一个问题，主机端看到多个LUN,其实是同一个LUN，未安装多路径主机看到两个物理LUN,安装了多路径主机看到一个LUN

```txt
　　　　　　　未安装多路径　　　　　　　　　　　　　　　　　安装了多路径
         Server主机看到两个LUN                 Server 主机看到一个LUN
                                                   虚拟磁盘
LUN                 LUN　　　　　　　　　　　　　　　　　磁盘驱动
 |                   |　　　　　　　　　　　　　　　　　多路径HBA
        硬　盘　驱　动                               多路径驱动
 |                   |　　　　　　　　　　　　　　　　｜　　　　　　｜
HBA1                HBA2　　　　　　　　　　　　　　HBA1       HBA2
          LUN阵列　　　　　　　　　　　　　　　　　　　　　　LUN阵列
```
多路径软件与OS集成方式
```txt
Application
File System
LVM
Disk
MultiPath
SCSI Layer
HBA Driver
```
UltraPath功能
- Failover故障路径自动切换
- FailBack 支持热插拔的系统链路恢复后会触发重新创建SCSI设备，不支持热插拔的设备AIX或低版本的Linux通过UltraPath周期感知路径恢复

虚拟网络组成

```txt

虚拟机　　虚拟机　　虚拟机
虚拟网卡　虚拟网卡　虚拟网卡

端口组　　端口组
   分布式交换机
上行链路1　　上行链路2
　　|         |
　　　  主机
   |         |
物理网卡１　　物理网卡２
　　物理网络
```

相关概念

|网络概念|说明|
|:---|:---|
|分布式交换机|分布式交换机是一个虚拟的交换机，功能类似于二层的物理交换机通过端口组与虚拟机连接，通过上行链路与物理网络连通|
|端口组|端口组是虚拟逻辑端口，类似于网络属性模板，用于定义虚拟机网卡属性通过分布式交换机连接到网络的方式|
||VLAN方式:使用该端口组的虚拟机网卡不会被分配IP地址(需要用户向虚拟机该网卡配置IP地址)但虚拟机会连接到端口组定义的VLAN|
|上行链路|上行链路是分布式交换机连接主机物理网卡的链路。用于虚拟机数据上行|