应用虚拟化可以简单描述为“以IT应用客户端集中部署平台为核心，以终端用户透明的方式，完全使用用户的应用和数据在云平台上统一计算和运行，并最终让用户获得与本地访问应用同样的应用感受和计算结果”

应用虚拟化是构建在Microsoft Windows Remote Desktop Service(RDS ,原Teminal Service)基础上，并提供了大量扩展的增强功能，用户可以使用各种终端设备，以会话共享的方式，访问运行在windows Server 2012服务器上的应用程序或共享界面

应用虚拟化原理
---

将后台服务器上安装的应用软件(OA,业务软件等)在虚拟交付平台上发布，用户登录平台访问后台应用软件时，应用软件运行在交付平台上，而不是运行在用户本地终端上

特点
- 所有应用软件都部署在数据中心服务器
- 所有应用软件都在交付平台上运行
- 终端仅接收交付平台上应用软件运行的屏幕画面

华为桌面应用虚拟化核心是HDP协议，该协议连接了平台上的应用客户端运行环境和远端终端设备，通过桌面协议的虚拟通道(分别传输各种输入输出数据如鼠标、键盘、图像、声音、端口、打印机等)

共享会话桌面和共享会话应用
---

共享会话桌面　桌面呈现windows7外观；能够在共享桌面打开各种应用办公；用户无法越权对操作系统进行修改；用户无法越权查看其它用户数据

共享会话应用　终端用户可以同时打开多个应用；各种操作(鼠标、键盘等外设)与其它用户隔离；用户无法越权对操作系统进行修改；用户无法查看到其它用户数据

应用虚拟化和本地应用对比

||本地应用|共享桌面|共享应用|
|:---|:---|:---|:---|
|用户体验|用户具有独立操作系统，体验较好|用户具有基于同一操作系统不同的桌面|仅看到应用，与运行本地应用体验几乎完全一致|
|硬件资源占用|高，每用户占用一定硬件资源|较低，每用户仅占用桌面所需资源|低，每用户仅占用运行应用所需的资源|
|数据安全性|低，数据与计算终端在本地，存在数据泄露风险|高，数据与计算在数据中心|高，数据与计算在数据中心|
|应用移动化|难，专门开发移动app|易，直接使用桌面云移动客户端|易，直接使用桌面云移动客户端|
|管理难度|高|低，仅需要管理共享的操作系统，以及发布的共享操作系统|低，仅需要管理共享的操作系统，以及发布的应用程序|

SBC虚拟应用优势：应用只安装一次；大幅度降低投入成本；应用和应用间的兼容性；移动端的广泛支持

SBC Server-Based Computing

VDI Virtual Desktop Infrastrucure

|对应版本|部署形态|应用场景特点|应用场景|
|:---|:---|:---|:---|
|企业版本|TC + VDI|个性化办公桌面；链接克隆桌面，应用统一更新|普通OA;安全办公；公用终端；云工作站；分支机构|
|企业增强版|TC+VID+SBC|个性化办公＋应用统一更新|普通OA;安全办公；公用终端；云工作站；分支机构|
|SBC版本|PC+SBC移动终端+SBC|应用集中管理；不改变当前PC办公架构|分支机构；移动办公；内外网隔离|

解决方案软件组件
---

|逻辑划分|组件名称|功能|
|:---|:---|:---|
|客户端|Access Client|HDP Client客户端|
|安全网关|vAG/SVN|安全接入网关|
|基础架构组件|WI|用户访问接入站点，进行应用呈现|
||HDC|提供会话接入管理功能|
||License|License许可协议服务器|
||GaussDB|存放系统数据|
||ITA|虚拟应用发放，监控系统性能和用户访问体验|
||TCM|对TC进行管理|
|应用发布服务器|RD Licensing|微软RDS访问许可协议|
||APS(HDA)|应用发布计算资源|

应用虚拟化大部分组件和VDI相同

APS(Application Server)用于对外发布应用或共享桌面的应用资源池服务器，其上面安装需要对用户发布的应用。主要是server2012个发布的应用程序

RDS服务提供了多会话(Multi-session)环境，

FusionAccess应用虚拟化也是在RDS服务基础上，支持基于windows server版本(server 2012 R2)的RDS服务来发布完整桌面和远程应用，远程访问传输采用HDP协议

应用虚拟化规划
---

- APS规格：　6vCPU、24G内存,80G硬盘空间
- IOPS总需求　OS为34个IOPS+5个IOPS*用户数
- 存储配置　可以根据需要配置NAS存储，用于存放用户配置文件和个人数据

每个服务器对应APS数量
- 2路6核服务器为4台APS
- 2路8核服务器为6台APS
- 2路10核服务器为7台APS
- 2路12核服务器为8台APS

APS所有vCPU的综合不能低于该服务器的超线程总数

应用虚拟化软件架构
---

- 管理集群　部署FusionCompute和FusionAccess管理软件
- 虚拟桌面资源池 应用虚拟化可以和虚拟桌面同时提供，可以单独只提供虚拟应用资源池
- 虚拟应用资源池　虚拟应用资源池具体提供共享桌面和虚拟应用。单个服务器上部署多个APS服务器，推荐是4~6,APS之间是负载均衡关系

部署RDS Licensing服务器流程

创建虚拟机--->安装操作系统--->配置RD Licensing 服务

在FusionAccess配置模板

业务类型--->“SBC”--->"桌面完整复制模板"

可以创建“APS虚拟机组”并将多台相同类型的APS服务器纳入到虚拟机组中，针对虚拟机组执行统一管理和维护，提升运维效率

配置RDS服务授权

创建APS服务器OU--->创建APS服务器组策略--->配置APS服务器的RDS服务授权

应用发放

创建OU--->创建用户组--->创建用户

配置Profile漫游数据

文件夹重定向　　网盘

添加APS 服务器　　添加虚拟机--->应用组--->app group

删除APS服务器　　应用组--->app group---VM 注销--->删除应用授权--->删除应用--->移除VM

更新/删除应用　　使用用户比较少的情况下，直接在APS服务器上安装/删除应用；用户数量特别大的情况下或者更新比较麻烦，新制作模板并发布

登录APS服务器--->安装新应用--->重新发布

更新虚拟机模板--->执行"更新虚拟机组软件"--->重新发布软件

添加/删除应用授权

问答题:应用虚拟化和桌面虚拟化的区别是？ 答:应用虚拟化依赖于windows Remote Desktop　Service(RDS)功能，而桌面虚拟化不需要